# Application Configuration
spring.application.name=cloud-kitchen-rbac-service
server.port=${PORT:8081}
server.address=0.0.0.0

# Timezone Configuration
spring.jpa.properties.hibernate.jdbc.time_zone=Asia/Kolkata
spring.jackson.time-zone=Asia/Kolkata

# Production: Hide error details
server.error.include-stacktrace=never
server.error.include-message=never
server.error.include-binding-errors=never

# Database - PostgreSQL Configuration
spring.datasource.url=${DATABASE_URL}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# Optimized JPA Configuration
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false

# Flyway Database Migration
spring.flyway.enabled=false
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true
spring.flyway.validate-on-migrate=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.jdbc.batch_size=50
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
spring.jpa.properties.hibernate.cache.use_second_level_cache=false
spring.jpa.properties.hibernate.generate_statistics=false

# JWT Configuration
app.jwt.secret=${JWT_SECRET}
app.jwt.access-valid-seconds=${JWT_ACCESS_EXPIRY:604800}
app.jwt.refresh-valid-seconds=${JWT_REFRESH_EXPIRY:259200}
app.jwt.issuer=cloud-kitchen-rbac

# CORS Configuration
cors.allowed.origins=*

# Swagger/OpenAPI Configuration
springdoc.api-docs.enabled=true
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.enabled=true
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.operations-sorter=alpha
springdoc.swagger-ui.tags-sorter=alpha
springdoc.swagger-ui.try-it-out-enabled=true
springdoc.swagger-ui.filter=true
# Use custom OpenAPI YAML specification
springdoc.swagger-ui.urls[0].name=Cloud Kitchen RBAC API
springdoc.swagger-ui.urls[0].url=/openapi/openapi.yaml
springdoc.swagger-ui.urls-primary-name=Cloud Kitchen RBAC API

# Prometheus Metrics Configuration
management.endpoints.web.exposure.include=health,info,prometheus,metrics
management.endpoint.prometheus.enabled=true
management.endpoint.metrics.enabled=true
management.prometheus.metrics.export.enabled=true
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.tags.application=cloud-kitchen-rbac

# Spring Security
spring.security.user.password=
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.UserDetailsServiceAutoConfiguration,org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration,org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration

# Redis Configuration (Disabled)
management.health.redis.enabled=false

# Logging Configuration
logging.level.com.cloudkitchen.rbac=INFO
logging.level.org.springframework.security=WARN
logging.level.org.springframework.web=WARN
logging.level.org.hibernate.SQL=WARN
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS}{Asia/Kolkata} [%thread] %-5level %logger{36} - %msg%n

# Performance Settings
server.tomcat.threads.max=500
server.tomcat.threads.min-spare=50
server.tomcat.max-connections=10000
server.tomcat.accept-count=1000
server.tomcat.connection-timeout=5000
server.compression.enabled=true

# Optimized Connection Pool
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=3000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# Security Headers
server.servlet.session.timeout=30m
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=false

# File Upload Configuration
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# AWS S3 Configuration (MANDATORY - Application will fail-fast if not configured)
# NOTE: Use environment variables or .env file for credentials (NEVER commit credentials to git)
aws.s3.access-key=${AWS_ACCESS_KEY}
aws.s3.secret-key=${AWS_SECRET_KEY}
aws.s3.region=${AWS_REGION:us-east-1}
aws.s3.bucket=${AWS_S3_BUCKET}
aws.s3.endpoint=${AWS_S3_ENDPOINT:}

# File Upload Limits
app.upload.max-file-size=10485760
app.upload.allowed-types=image/jpeg,image/jpg,image/png,image/webp


# Async Processing Configuration
spring.task.execution.pool.core-size=5
spring.task.execution.pool.max-size=20
spring.task.execution.pool.queue-capacity=100
spring.task.execution.thread-name-prefix=async-

# Data Initialization
app.data.initialize=${DATA_INITIALIZE:false}

# DevTools - Auto Restart Configuration (Development Only)
spring.devtools.restart.enabled=${DEVTOOLS_ENABLED:false}
spring.devtools.restart.additional-paths=src/main/java
spring.devtools.livereload.enabled=${DEVTOOLS_ENABLED:false}
